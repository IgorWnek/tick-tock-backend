# Copilot Commit Message Instructions

Follow the **Conventional Commits** specification for all commit messages. This repository uses `@commitlint/config-conventional` to enforce commit message standards.

## Commit Message Format

```text
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

## Types

- **feat**: A new feature for the user (adds functionality)
- **fix**: A bug fix for the user (fixes existing functionality)
- **docs**: Documentation only changes
- **style**: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)
- **refactor**: A code change that neither fixes a bug nor adds a feature
- **perf**: A code change that improves performance
- **test**: Adding missing tests or correcting existing tests
- **build**: Changes that affect the build system or external dependencies (example scopes: npm, docker, webpack)
- **ci**: Changes to CI configuration files and scripts (example scopes: github-actions, azure-pipelines)
- **chore**: Other changes that don't modify src or test files
- **revert**: Reverts a previous commit

**Note**: Types other than `feat` and `fix` MAY be used. The above list represents the conventional standard types.

## Scopes (Optional but Recommended)

A scope MUST consist of a noun describing a section of the codebase surrounded by parentheses. Multiple scopes are supported using delimiters: `/`, `\`, and `,`.

Use these scopes to indicate the area of change:

### Architecture Components

- **actions**: Action classes and handlers
- **commands**: Command classes and command handlers
- **queries**: Query classes and query handlers
- **entities**: Database entities and models
- **repositories**: Repository classes
- **middleware**: Express middleware
- **routing**: Route configurations
- **graphql**: GraphQL resolvers, types, mutations, queries
- **subscribers**: Event subscribers
- **migrations**: Database migrations

### Feature Areas

- **auth**: Authentication and authorization
- **users**: User management
- **api**: REST API endpoints
- **health**: Health check endpoints
- **error-handling**: Error handling and responses

### Infrastructure

- **docker**: Docker configuration
- **database**: Database configuration and setup
- **config**: Application configuration
- **deps**: Dependencies and package updates
- **ci/cd**: CI/CD pipelines and deployment
- **tools**: Development tools and utilities

## Examples

### Feature Development

```text
feat(users): add user registration endpoint

- Add CreateUserCommand and CreateUserHandler
- Add user validation middleware
- Include password hashing
- Add integration tests for registration flow

Closes #123
```

### Bug Fixes

```text
fix(auth): resolve JWT token expiration handling

- Fix token refresh logic in auth middleware
- Add proper error responses for expired tokens
- Update error handler for authentication failures
```

### Code Generation/Plop Changes

```text
feat(plop): add new feature template generator

- Create feature directory structure template
- Add CRUD action templates
- Include routing and test file generation
```

### Database Changes

```text
feat(migrations): add user profile table

- Create UserProfile entity
- Add migration for user_profiles table
- Include foreign key relationship to users
```

### GraphQL Changes

```text
feat(graphql): add user queries and mutations

- Add getUserById and getUsers queries
- Add createUser and updateUser mutations
- Include input validation and error handling
```

### Testing

```text
test(users): add integration tests for user endpoints

- Add tests for user creation
- Add tests for user authentication
- Include edge cases and error scenarios
```

### Documentation

```text
docs(api): update Swagger documentation for user endpoints

- Add OpenAPI specs for user CRUD operations
- Include request/response examples
- Update authentication requirements
```

### Refactoring

```text
refactor(commands): improve command handler error handling

- Extract common error handling logic
- Standardize error response format
- Improve type safety for command responses
```

### Performance

```text
perf(database): optimize user query performance

- Add database indexes for frequently queried fields
- Implement query result caching
- Reduce N+1 query problems
```

### Configuration/Build

```text
build(docker): update Node.js version to 20

- Update Dockerfile base image
- Update docker-compose configuration
- Update package.json engines requirement
```

### Reverting Changes

```text
revert: let us never again speak of the noodle incident

Refs: 676104e, a215868
```

## Guidelines

1. **Use imperative mood**: "add feature" not "added feature"
2. **Be concise but descriptive**: Subject line should be 50 characters or less (max 100 for header)
3. **Capitalize first letter**: Start with a capital letter after the colon
4. **No period at the end**: Don't end the subject line with a period
5. **Use body for context**: Explain what and why, not how
6. **Reference issues**: Include issue numbers when applicable using `Closes #123`, `Fixes #123`, or `Refs: #123`
7. **Line length limits**: Body and footer lines should not exceed 100 characters
8. **Blank lines required**: One blank line between header and body, one blank line between body and footer
9. **Case sensitivity**: All elements are case-insensitive except `BREAKING CHANGE` which MUST be uppercase

## Breaking Changes

Breaking changes MUST be indicated either:

1. **In the type/scope prefix** with `!` immediately before `:`
2. **As a footer** with `BREAKING CHANGE:` followed by description

### Breaking Change Examples

```text
feat(api)!: send an email to the customer when a product is shipped

BREAKING CHANGE: `extends` key in config file is now used for extending other config files
```

```text
chore!: drop support for Node 6

BREAKING CHANGE: use JavaScript features not available in Node 6.
```

**Note**: `BREAKING-CHANGE` is synonymous with `BREAKING CHANGE` when used in footer.

## Footer Format

Footers MUST follow one of these formats:

- `<token>: <value>` (e.g., `Reviewed-by: Z`)
- `<token> #<value>` (e.g., `Refs #123`)

Footer tokens MUST use `-` in place of whitespace characters (e.g., `Acked-by`), except for `BREAKING CHANGE`.

## Repository-Specific Notes

- This is a TypeScript Express.js application with GraphQL support
- Code generation is done via Plop templates
- Quality gates include ESLint, Prettier, and comprehensive tests
- Architecture follows CQRS patterns with commands, queries, and handlers
- Database uses TypeORM with PostgreSQL
- Authentication uses JWT tokens
- All changes must pass linting and tests (enforced by pre-push hooks)
- Commitlint enforces maximum header length of 100 characters
- Body and footer lines are limited to 100 characters each

## Common Commit Patterns for This Repository

- `feat(actions): add [FeatureName]Action`
- `feat(commands): add [CommandName]Command and handler`
- `feat(queries): add [QueryName]Query and handler`
- `feat(entities): add [EntityName] entity`
- `feat(migrations): add [description] migration`
- `feat(graphql): add [operationName] resolver`
- `test(integration): add tests for [feature]`
- `fix(middleware): resolve [specific issue]`
- `chore(deps): update dependencies`
- `docs: update README with [information]`
